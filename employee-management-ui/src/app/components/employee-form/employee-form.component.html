<div class="employee-form-container">
  <div class="form-header">
    <h2 mat-dialog-title>{{ isEditMode ? 'Edit Employee' : 'Add New Employee' }}</h2>
    <button mat-icon-button (click)="onCancel()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()" class="employee-form">
    <mat-tab-group>
      <!-- Personal Information Tab -->
      <mat-tab label="Personal Information">
        <div class="tab-content">
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Full Name *</mat-label>
              <input matInput formControlName="fullName" placeholder="Enter full name">
              <mat-error>{{ getFieldError(personalForm, 'fullName') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Gender *</mat-label>
              <mat-select formControlName="gender">
                <mat-option value="M">Male</mat-option>
                <mat-option value="F">Female</mat-option>
              </mat-select>
              <mat-error>{{ getFieldError(personalForm, 'gender') }}</mat-error>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Date of Birth *</mat-label>
              <input matInput [matDatepicker]="picker" formControlName="dob">
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
              <mat-error>{{ getFieldError(personalForm, 'dob') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Age</mat-label>
              <input matInput formControlName="age" readonly>
              <mat-hint>Auto-calculated from date of birth</mat-hint>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Email *</mat-label>
              <input matInput formControlName="email" placeholder="Enter email address">
              <mat-error>{{ getFieldError(personalForm, 'email') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Contact Number *</mat-label>
              <input matInput formControlName="contactNo" placeholder="Enter contact number">
              <mat-error>{{ getFieldError(personalForm, 'contactNo') }}</mat-error>
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="form-field full-width">
            <mat-label>Address *</mat-label>
            <textarea matInput formControlName="address" rows="3" placeholder="Enter address"></textarea>
            <mat-error>{{ getFieldError(personalForm, 'address') }}</mat-error>
          </mat-form-field>

          <!-- Profile Image Upload -->
          <div class="image-upload-section">
            <h3>Profile Image</h3>
            <div class="image-upload-container">
              <div class="image-preview" *ngIf="imagePreview">
                <img [src]="imagePreview" alt="Profile Preview" class="preview-image">
                <button mat-icon-button color="warn" (click)="removeImage()" class="remove-image-btn">
                  <mat-icon>close</mat-icon>
                </button>
              </div>
              <div class="upload-area" *ngIf="!imagePreview">
                <mat-icon>cloud_upload</mat-icon>
                <p>No image selected</p>
              </div>
              <input #imageInput type="file" accept="image/*" (change)="onImageSelected($event)" style="display: none;">
              <button mat-stroked-button type="button" (click)="imageInput.click()">
                <mat-icon>add_photo_alternate</mat-icon>
                {{ imagePreview ? 'Change Image' : 'Upload Image' }}
              </button>
            </div>
          </div>
        </div>
      </mat-tab>

      <!-- Professional Information Tab -->
      <mat-tab label="Professional Information">
        <div class="tab-content">
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Designation *</mat-label>
              <input matInput formControlName="designation" placeholder="Enter designation">
              <mat-error>{{ getFieldError(professionalForm, 'designation') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Department *</mat-label>
              <input matInput formControlName="department" placeholder="Enter department">
              <mat-error>{{ getFieldError(professionalForm, 'department') }}</mat-error>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Qualification</mat-label>
              <input matInput formControlName="qualification" placeholder="Enter qualification">
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Experience (Years)</mat-label>
              <input matInput type="number" formControlName="experience" placeholder="Enter years of experience">
              <mat-error>{{ getFieldError(professionalForm, 'experience') }}</mat-error>
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="form-field full-width">
            <mat-label>Skills</mat-label>
            <textarea matInput formControlName="skill" rows="3" placeholder="Enter skills (comma separated)"></textarea>
          </mat-form-field>

          <!-- Profile Document Upload -->
          <div class="document-upload-section">
            <h3>Profile Document</h3>
            <div class="document-upload-container">
              <div class="document-preview" *ngIf="documentPreview">
                <mat-icon>description</mat-icon>
                <span>{{ documentPreview }}</span>
                <button mat-icon-button color="warn" (click)="removeDocument()" class="remove-document-btn">
                  <mat-icon>close</mat-icon>
                </button>
              </div>
              <div class="upload-area" *ngIf="!documentPreview">
                <mat-icon>cloud_upload</mat-icon>
                <p>No document selected</p>
              </div>
              <input #documentInput type="file" accept=".pdf,.doc,.docx" (change)="onDocumentSelected($event)" style="display: none;">
              <button mat-stroked-button type="button" (click)="documentInput.click()">
                <mat-icon>attach_file</mat-icon>
                {{ documentPreview ? 'Change Document' : 'Upload Document' }}
              </button>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>

    <div class="form-actions">
      <button mat-button type="button" (click)="onCancel()">Cancel</button>
      <button mat-raised-button color="primary" type="submit" [disabled]="isLoading">
        <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
        <span *ngIf="!isLoading">{{ isEditMode ? 'Update' : 'Create' }} Employee</span>
      </button>
    </div>
  </form>
</div>